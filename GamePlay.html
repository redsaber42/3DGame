<!DOCTYPE html>
<html>
   <head>
      <title>Limit Stick Travel Game Test 4.5</title>
   </head>
   <body style=“position:fixed; touch-action:none;”>
      <div id="help" style="position:fixed; left:40%; top:4%; color:grey;">
         virtualjoystick.js Limit Stick-Travel Demo with Stationary Base
      </div>

      <div id="debug1" style="position:fixed; left:5%; top:4%; color:grey;">
         Debug Info X is not currently available.
      </div>

      <div id="debug2" style="position:fixed; left:5%; top:8%; color:grey;">
         Debug Info Z is not currently available.
      </div>

      <script src="JS/three.min.js"></script>
      <script src="JS/keyboard.js"></script>
      <script src="JS/virtualjoystick.js"></script>

      <div style=“position:fixed; touch-action:none;”>
      <script>
	var scene, camera, renderer, clock, deltaTime, totalTime, keyboard;
	
	// Create Scene
        scene = new THREE.Scene();
        
	// Create Camera
	camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
	camera.position.set(0, 2, 2);
	camera.lookAt( scene.position );
	      
	// Create Clock
	clock = new THREE.Clock();
	deltaTime = 0;
	totalTime = 0;
	   
	// Create Light
	let ambientLight = new THREE.AmbientLight( 0xcccccc, 1.00 );
	ambientLight.position.set(0, 10, 10);
	scene.add( ambientLight );
	      
	 

	keyboard = new Keyboard();
	var joystick = new VirtualJoystick({
                      mouseSupport: true,
		      stationaryBase: true,
                      baseX: window.innerWidth / 6,
                      baseY: window.innerHeight / 4 * 2.5,
		      limitStickTravel: true,
		      stickRadius: 50
         });

	var renderer = new THREE.WebGLRenderer();
	renderer.setSize(window.innerWidth, window.innerHeight);
	document.body.appendChild(renderer.domElement);
	window.addEventListener('resize', onWindowResize, false); 

	var cubeGeometry = new THREE.CubeGeometry(1,1,1);
	var cubeMaterial = new THREE.MeshLambertMaterial({ color: 'rgb(0,0,255)' });
	var cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
	cube.position.set( 0, 0, 0 );
	scene.add(cube);
	      
	var planeGeometry = new THREE.PlaneGeometry(20,20,20);
	var planeMaterial = new THREE.MeshLambertMaterial({ color: 'rgb(255,255,255)' });
	var plane = new THREE.Mesh(cubeGeometry, cubeMaterial);
	plane.position.set( 0, -30, 0 );
	scene.add(plane);

	var debugText1 = document.getElementById("debug1");
	var debugText2 = document.getElementById("debug2");

	animate();

	function animate(){
   
   	   requestAnimationFrame(animate);

   	   deltaTime = clock.getDelta();
           totalTime += deltaTime;
		
           update();
           render();
   	   debugText1.innerHTML = "Cube position X: " + cube.position.x.toFixed(1);
  	   debugText2.innerHTML = "Cube position Z: " + cube.position.z.toFixed(1);
   
	}
	      
	function render()
        {
                renderer.render( scene, camera );
        }
	      
	function update(){
		
          keyboard.update();
		
	  let translateSpeed = 1; // units per second
	  let distance = translateSpeed * deltaTime;
   
   	  if( keyboard.isKeyPressed("D") ){
 	    cube.translateX( distance );
   	  }
   	  if( keyboard.isKeyPressed("A") ){
 	    cube.translateX( -distance );
  	  }
   	  if( keyboard.isKeyPressed("W") ){
	     cube.translateZ( -distance );
   	  }
   	  if( keyboard.isKeyPressed("S") ){
 	    cube.translateZ( distance );
   	  }

  	  if( joystick.right() ){
	     cube.translateX( distance );  
   	   }
  	   if( joystick.left() ){
	     cube.translateX( -distance );   
 	   }
  	   if( joystick.up() ){
	     cube.translateZ( -distance );      
 	   }
 	   if( joystick.down() ){
 	     cube.translateZ( distance );
   	   }
	
	}

	function onWindowResize(){
   	  camera.aspect = window.innerWidth / window.innerHeight;
  	  camera.updateProjectionMatrix();
   	  renderer.setSize( window.innerWidth, window.innerHeight );   
	}
      </script>   
      </div>  
   </body>
</html>
